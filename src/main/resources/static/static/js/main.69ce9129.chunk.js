(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{50:function(e,t,n){},52:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n(20),a=n.n(s),c=n(3),o=(n(50),n(4)),l=n(12),i=(n(51),n(52),n(6)),u=n.n(i),j=n(13),b=n(5),d=n(37),p=n.n(d).a.create({baseURL:"http://localhost:8080/api",headers:{"Content-type":"application/json"}}),h="spaces/",m={getAll:function(){var e=Object(j.a)(u.a.mark((function e(t){var n,r,s,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.get("/spaces/users");case 2:return n=e.sent,r=n.data,s=r.filter((function(e){return e.name==t})),a=r.filter((function(e){return e.name!=t})),e.abrupt("return",{userBlogs:s.flatMap((function(e){return e.blogs?e.blogs.map((function(t){return Object(b.a)(Object(b.a)({},t),{},{link:h+e.name+"/"+t.id})})):[]})),otherBlogs:a.flatMap((function(e){return e.blogs?e.blogs.map((function(t){return Object(b.a)(Object(b.a)({},t),{},{link:h+e.name+"/"+t.id})})):[]}))});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getBlog:function(){var e=Object(j.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.get(t);case 2:if(n=e.sent,!(r=n.data.optionalBlog)||!r.posts){e.next=7;break}return r.posts=r.posts.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{link:t+"/"+e.id})})),e.abrupt("return",r);case 7:return e.abrupt("return",{id:"",title:"",posts:[],theme:null});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g="REGISTER_SUCCESS",O="REGISTER_FAIL",f="LOGIN_SUCCESS",v="LOGIN_FAIL",x="LOGOUT",N="SET_MESSAGE",y="CLEAR_MESSAGE",S="GET_ALL_BLOGS",w="GET_BLOG",k="GET_POST",B=n(1),E=function(){var e=Object(c.c)((function(e){return e.blogs})),t=Object(c.c)((function(e){return e.authentication.user})),n=Object(c.b)();return Object(r.useEffect)((function(){var e;n((e=t&&t.name,function(){var t=Object(j.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.getAll(e);case 3:r=t.sent,n({type:S,allBlogs:r}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()))}),[]),Object(B.jsx)("div",{className:"list row",children:Object(B.jsxs)("div",{className:"col-md-12",children:[Object(B.jsx)("h1",{children:"Blogs"}),e.userBlogs&&Object(B.jsx)("ul",{className:"list-group",children:e.userBlogs.map((function(e,t){return Object(B.jsx)("li",{className:"list-group-item",children:Object(B.jsx)(l.a,{to:e.link,className:"nav-link",children:e.title})},t)}))}),e.otherBlogs&&Object(B.jsx)("ul",{className:"list-group",children:e.otherBlogs.map((function(e,t){return Object(B.jsx)("li",{className:"list-group-item",children:Object(B.jsx)(l.a,{to:e.link,className:"nav-link",children:e.title})},t)}))}),(!e.userBlogs||0==e.userBlogs.length)&&(!e.otherBlogs||0==e.otherBlogs.length)&&Object(B.jsx)("span",{children:"The space is ready for blogs. Please, create your blog."})]})})},I=n(15),L=n(21),C=n.n(L),R=n(17),P=n.n(R),A=n(22),G=n.n(A),T=function(e){return{type:N,payload:e}},_={buildHttpHeader:function(){var e=localStorage.getItem("user");if(!e)return{};var t=JSON.parse(e);return t&&t.token?{Authorization:"Bearer "+t.token}:{}}},F={getAll:function(){return p.get("/spaces/users",{headers:_.buildHttpHeader()})},register:function(e,t){return p.post("/spaces/register",{username:e,password:t})},login:function(e,t){return p.post("/spaces/authenticate",{username:e,password:t}).then((function(e){return e.data.token&&localStorage.setItem("user",JSON.stringify(e.data)),e.data}))},logout:function(){localStorage.removeItem("user")}},U=function(e,t){return function(n){return F.register(e,t).then((function(e){return n({type:g}),n(T(e.data.message)),Promise.resolve()}),(function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();return n({type:O}),n(T(t)),Promise.reject()}))}},M=function(e,t){return function(n){return F.login(e,t).then((function(e){return n({type:f,payload:{user:e}}),Promise.resolve()}),(function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();return n({type:v}),n(T(t)),Promise.reject()}))}},D=function(){return function(e){F.logout(),e({type:x})}},J=function(e){if(!e)return Object(B.jsx)("div",{className:"alert alert-danger",role:"alert",children:"(required)"})},H=function(e){var t=Object(r.useRef)(),n=Object(r.useRef)(),s=Object(r.useState)(""),a=Object(I.a)(s,2),l=a[0],i=a[1],u=Object(r.useState)(""),j=Object(I.a)(u,2),b=j[0],d=j[1],p=Object(r.useState)(!1),h=Object(I.a)(p,2),m=h[0],g=h[1],O=Object(c.c)((function(e){return e.authentication.isLoggedIn})),f=Object(c.c)((function(e){return e.message.message})),v=Object(c.b)();return O?Object(B.jsx)(o.a,{to:"/spaces"}):Object(B.jsx)("div",{className:"col-md-12",children:Object(B.jsx)("div",{className:"card card-container",children:Object(B.jsxs)(C.a,{onSubmit:function(r){r.preventDefault(),g(!0),t.current.validateAll(),0===n.current.context._errors.length?v(M(l,b)).then((function(){e.history.push("/"),window.location.reload()})).catch((function(){g(!1)})):g(!1)},ref:t,children:[Object(B.jsxs)("div",{className:"form-group",children:[Object(B.jsx)("label",{htmlFor:"username",children:"USER NAME"}),Object(B.jsx)(P.a,{type:"text",className:"form-control",name:"username",value:l,onChange:function(e){var t=e.target.value;i(t)},validations:[J]})]}),Object(B.jsxs)("div",{className:"form-group",children:[Object(B.jsx)("label",{htmlFor:"password",children:"PASSWORD"}),Object(B.jsx)(P.a,{type:"password",className:"form-control",name:"password",value:b,onChange:function(e){var t=e.target.value;d(t)},validations:[J]})]}),Object(B.jsx)("div",{className:"text-center",children:Object(B.jsxs)("button",{className:"btn btn-light btn-block",disabled:m,children:[m&&Object(B.jsx)("span",{className:"spinner-border spinner-border-sm"}),Object(B.jsx)("span",{children:"SIGN IN"})]})}),f&&Object(B.jsx)("div",{className:"form-group",children:Object(B.jsx)("div",{className:"alert alert-danger",role:"alert",children:f})}),Object(B.jsx)(G.a,{style:{display:"none"},ref:n})]})})})},W=function(e){if(!e)return Object(B.jsx)("div",{className:"alert alert-danger",role:"alert",children:"(required)"})},q=function(e){if(e.length<3||e.length>20)return Object(B.jsx)("div",{className:"alert alert-danger",role:"alert",children:"(must be between 3 and 20 characters)"})},z=function(e){if(e.length<6||e.length>40)return Object(B.jsx)("div",{className:"alert alert-danger",role:"alert",children:"(must be between 6 and 40 characters)"})},K=function(){var e=Object(r.useRef)(),t=Object(r.useRef)(),n=Object(r.useState)(""),s=Object(I.a)(n,2),a=s[0],l=s[1],i=Object(r.useState)(""),u=Object(I.a)(i,2),j=u[0],b=u[1],d=Object(r.useState)(!1),p=Object(I.a)(d,2),h=p[0],m=p[1],g=Object(c.c)((function(e){return e.message.message})),O=Object(c.b)();return h?Object(B.jsx)(o.a,{to:"/spaces/login"}):Object(B.jsx)("div",{className:"col-md-12",children:Object(B.jsx)("div",{className:"card card-container",children:Object(B.jsxs)(C.a,{onSubmit:function(n){n.preventDefault(),m(!1),e.current.validateAll(),0===t.current.context._errors.length&&O(U(a,j)).then((function(){m(!0)})).catch((function(){m(!1)}))},ref:e,children:[!h&&Object(B.jsxs)("div",{children:[Object(B.jsxs)("div",{children:[Object(B.jsx)("label",{htmlFor:"username",children:"USER NAME"}),Object(B.jsx)(P.a,{type:"text",className:"form-control",name:"username",value:a,onChange:function(e){var t=e.target.value;l(t)},validations:[W,q]})]}),Object(B.jsxs)("div",{children:[Object(B.jsx)("label",{htmlFor:"password",children:"PASSWORD"}),Object(B.jsx)(P.a,{type:"password",className:"form-control",name:"password",value:j,onChange:function(e){var t=e.target.value;b(t)},validations:[W,z]})]}),Object(B.jsx)("div",{className:"text-center",children:Object(B.jsx)("button",{className:"btn btn-light btn-block",children:"SIGN UP"})})]}),g&&Object(B.jsx)("div",{className:"form-group",children:Object(B.jsx)("div",{className:"alert alert-danger",role:"alert",children:g})}),Object(B.jsx)(G.a,{style:{display:"none"},ref:t})]})})})},Q=n(7),V=function(e){var t,n=Object(o.g)(),s=Object(c.c)((function(e){return e.blog})),a=Object(c.b)();return Object(r.useEffect)((function(){var e;a((e=n.pathname,function(){var t=Object(j.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.getBlog(e);case 3:r=t.sent,n({type:w,blog:r}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()))}),[]),Object(B.jsx)("div",{className:"list row",style:s.theme?{backgroundColor:null===(t=s.theme)||void 0===t?void 0:t.blogBackgroundColor,color:s.theme.blogColor}:{},children:Object(B.jsxs)("div",{className:"col-md-12",children:[Object(B.jsx)("h1",{children:s.title}),s.posts&&Object(B.jsx)("ul",{className:"list-group",children:s.posts.map((function(e,t){return Object(B.jsx)("li",{className:"list-group-item",children:Object(B.jsx)(l.a,{to:e.link,className:"nav-link",children:e.title})},t)}))}),(!s.posts||0==s.posts.length)&&Object(B.jsx)("span",{children:"Nothing here right now."})]})})},X={getPost:function(){var e=Object(j.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.get(t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Y=function(e){var t=Object(o.g)(),n=Object(c.c)((function(e){return e.post})),s=Object(c.c)((function(e){return e.blog.theme})),a=Object(c.b)();return Object(r.useEffect)((function(){var e;a((e=t.pathname,function(){var t=Object(j.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,X.getPost(e);case 3:r=t.sent,n({type:k,getPostResponse:r}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()))}),[]),Object(B.jsx)("div",{className:"list row",style:s?{backgroundColor:s.postBackgroundColor,color:s.postColor}:{},children:Object(B.jsxs)("div",{className:"col-md-12",children:[Object(B.jsx)("h1",{children:n.title}),Object(B.jsx)("div",{children:n.description}),n.comments&&Object(B.jsx)("ul",{className:"list-group",children:n.comments.map((function(e,t){return Object(B.jsx)("li",{className:"list-group-item",children:Object(B.jsxs)("div",{children:[Object(B.jsxs)("span",{className:"commentUserName",children:[e.userName,": "]}),e.text]})},t)}))})]})})},Z=Object(Q.a)(),$=function(){var e=Object(c.c)((function(e){return e.authentication.user})),t=Object(c.b)();Object(r.useEffect)((function(){Z.listen((function(e){t({type:y})}))}),[t]);return Object(B.jsx)(o.c,{history:Z,children:Object(B.jsxs)("div",{children:[Object(B.jsxs)("nav",{className:"navbar navbar-expand",children:[Object(B.jsx)(l.a,{to:"/spaces",className:"navbar-brand ms-1",children:"Blog Spaces"}),e?Object(B.jsx)("div",{className:"navbar-nav ms-auto",children:Object(B.jsx)("li",{className:"nav-item",children:Object(B.jsx)("a",{href:"/spaces/login",className:"nav-link",onClick:function(){t(D())},children:"LogOut"})})}):Object(B.jsxs)("div",{className:"navbar-nav ms-auto",children:[Object(B.jsx)("li",{className:"nav-item",children:Object(B.jsx)(l.a,{to:"/spaces/login",className:"nav-link",children:"Login"})}),Object(B.jsx)("li",{className:"nav-item",children:Object(B.jsx)(l.a,{to:"/spaces/register",className:"nav-link",children:"Sign Up"})})]})]}),Object(B.jsx)("div",{className:"container mt-3",children:Object(B.jsxs)(o.d,{children:[Object(B.jsx)(o.b,{exact:!0,path:"/",children:Object(B.jsx)(o.a,{to:"/spaces"})}),Object(B.jsx)(o.b,{exact:!0,path:["/spaces/"],component:E}),Object(B.jsx)(o.b,{exact:!0,path:"/spaces/login",component:H}),Object(B.jsx)(o.b,{exact:!0,path:"/spaces/register",component:K}),Object(B.jsx)(o.b,{exact:!0,path:"/spaces/:userName/:blogId",component:V}),Object(B.jsx)(o.b,{exact:!0,path:"/spaces/:userName/:blogId/:postId",component:Y})]})})]})})},ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,83)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),s(e),a(e),c(e)}))},te=n(16),ne=n(39),re=n(40),se=localStorage.getItem("user"),ae=se?JSON.parse(se):null,ce=ae?{isLoggedIn:!0,user:ae}:{isLoggedIn:!1,user:null},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case g:case O:return Object(b.a)(Object(b.a)({},e),{},{isLoggedIn:!1});case f:return Object(b.a)(Object(b.a)({},e),{},{isLoggedIn:!0,user:r.user});case v:case x:return Object(b.a)(Object(b.a)({},e),{},{isLoggedIn:!1,user:null});default:return e}},le={message:""},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case N:return{message:r};case y:return{message:""};default:return e}},ue={userBlogs:[],otherBlogs:[]},je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.allBlogs;switch(n){case S:return r;default:return e}},be={id:"",title:"",theme:null,posts:[]},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0,n=t.type;switch(n){case w:return t.blog;case k:return Object(b.a)(Object(b.a)({},e),{},{theme:t.getPostResponse.optionalTheme});default:return e}},pe={id:"",title:"",description:"",comments:[]},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0,n=t.type;switch(n){case k:return t.getPostResponse.optionalPost;default:return e}},me=Object(te.combineReducers)({authentication:oe,message:ie,blogs:je,blog:de,post:he}),ge=[re.a],Oe=Object(te.createStore)(me,Object(ne.composeWithDevTools)(te.applyMiddleware.apply(void 0,ge)));a.a.render(Object(B.jsx)(c.a,{store:Oe,children:Object(B.jsx)($,{})}),document.getElementById("root")),ee()}},[[82,1,2]]]);
//# sourceMappingURL=main.69ce9129.chunk.js.map